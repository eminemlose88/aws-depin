我将为你实现一套完整的会员与计费系统，并将实例启动与项目部署逻辑分离。

### 1. 数据库架构升级 (`schema.sql`)
*   **`profiles` 表**: 扩展用户资料，增加 `balance` (余额), `membership_tier` (会员等级), `daily_request_count` (每日请求数) 等字段。
*   **`transactions` 表**: 记录充值和扣费流水。
*   **`billing_logs` 表**: 每日计费详单。

### 2. 后端逻辑重构
*   **计费模块 (`billing.py`)**:
    *   实现每日扣费逻辑（基础费 + 实例费）。
    *   实现功能权限检查装饰器（余额为0限制）。
*   **逻辑分离 (`logic.py`)**:
    *   **Phase 1 - 开机**: `launch_base_instance` 只负责启动纯净的 EC2 实例（安装 Docker/SSM Agent）。
    *   **Phase 2 - 部署**: `deploy_project` 负责通过 SSH/SSM 在已运行的实例上安装 Titan 等项目。

### 3. 前端界面升级 (`app.py`)
*   **会员中心**: 显示余额、充值入口（模拟充值）、消费记录。
*   **分步部署**:
    *   Step 1: 启动纯净实例（需鉴权扣费）。
    *   Step 2: 选择实例 -> 安装项目（Titan/Meson等）。
*   **权限控制**: 在关键操作按钮（开机、检测、修复）前增加 `check_balance()` 检查。

### 4. 定时任务 (模拟)
*   由于 Streamlit 是被动触发的，我们可以在用户登录时或管理员面板中触发“每日结算”逻辑，或者提供一个 API 端点供外部 Cron 触发。

### 5. 自动替补与检测 (Auto-Scaling & GFW Check)
*   **自动替补**: 在 `monitor.py` 中增加逻辑，如果检测到实例状态为 `terminated` 且用户开启了“自动替补”，则自动调用开机接口。
*   **GFW 检测**: 集成简单的 TCP Ping 检测逻辑。

这套方案将实现你要求的商业化闭环。