我将为你实现管理员后台功能，并修复你的管理员账号数据。

### 1. 数据库升级 (`schema.sql` / `update_admin.sql`)
*   **`profiles` 表**: 增加 `role` 字段 (默认为 `user`, 管理员为 `admin`)。
*   **SQL 补丁**: 编写 SQL 语句，手动将你的账号 (`b2764540...`) 插入 `profiles` 表并设置为 `admin`。

### 2. 后端逻辑重构
*   **`admin.py`**:
    *   创建独立的管理员后台页面逻辑。
    *   功能：查看所有用户、修改用户余额、查看全平台流水、手动触发全局结算。
    *   **安全检查**: 在加载此页面前，必须验证当前用户的 `role` 是否为 `admin`。
*   **`auth.py`**:
    *   注册时自动创建 `profiles` 记录（虽然已有触发器，但在代码层面确保逻辑完整）。
    *   登录后将用户角色信息存储在 `session_state` 中。

### 3. 前端界面升级 (`app.py`)
*   **管理员入口**: 在侧边栏底部，如果检测到当前用户是 `admin`，则显示“进入管理员后台”按钮。
*   **页面路由**: 点击按钮后，加载 `admin.py` 的界面，替代普通用户界面。

### 4. 修复你的账号
*   提供一个专门的 SQL 脚本，你需要在 Supabase SQL Editor 中运行它，手动补全你的账号信息。

### 执行计划
1.  创建 `update_admin_schema.sql`，包含字段更新和你账号的修复 SQL。
2.  创建 `admin.py`，实现用户管理和全局计费功能。
3.  更新 `app.py`，集成管理员权限检查和页面路由。
4.  更新 `auth.py`，确保登录时获取角色信息。